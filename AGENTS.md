# Project-specific AI guidance

## Build and Development Workflow

### Build Process

This project uses Webpack to build TypeScript and WGSL shaders into a static HTML application.

```bash
npm run build    # Build to dist/
npm start        # Start dev server
```

**Important**:
- The final output is a **static HTML file** at `dist/index.html`, along with bundled JavaScript.

### Project Structure

The project is organized as a single WebGPU simulation:

```
src/
├── index.ts              # Main entry point and simulation logic
├── utils.ts              # Shared WebGPU utilities
├── wgsl.ts               # WGSL struct and buffer management
├── index.html            # HTML template (processed by webpack)
├── assets/               # Static assets (images, favicon, etc.)
└── shaders/              # WGSL shader files
    ├── compute.wgsl      # Compute shader
    ├── render.wgsl       # Render shader (vertex + fragment)
    └── includes/         # Shared WGSL code (imported via #import)
        ├── bindings.wgsl       # Binding layout definitions
        ├── textures.wgsl       # Texture declarations
        └── interactions.wgsl   # Interaction structs

dist/                     # Built output (generated by webpack)
├── index.html            # Final HTML (includes bundled scripts)
├── index.bundle.js       # Bundled application code
└── runtime.bundle.js     # Webpack runtime
```

## Testing and Validation

### Automated Capture Tool

After making code changes, use the capture tool to verify the simulation works:

```bash
# Build first
npm run build

# Standard capture (10 screenshots at 500ms intervals)
npm run capture

# Custom capture with explicit arguments
npm run capture -- --screenshots 5 --interval 1000
```

Check `.capture/session-[timestamp]/` for results.

### When to Use Capture Tool

**Always capture after**:
- Modifying shaders
- Changing simulation logic
- Updating WebGPU initialization
- Making any code changes that affect rendering

## Architecture Principles

### Includes System for Shared WGSL Code

The template uses a custom `#import` system to eliminate duplication:

1. **Define once** in `src/shaders/includes/bindings.wgsl`.
2. **Declare once** in `src/shaders/includes/textures.wgsl`.
3. **Import everywhere** using `#import includes::bindings` and `#import includes::textures`.

### setupTextures Utility Simplifies Texture Management

The `setupTextures()` function in `utils.ts` automates texture creation, data upload, and binding layout setup.
